-- الانتظار حتى يتم تحميل اللعبة بالكامل
repeat task.wait() until game:IsLoaded()

-- الخدمات الأساسية
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")
local LocalPlayer = Players.LocalPlayer

-- الانتظار حتى يتم تحميل PlayerGui
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui", 10)
if not PlayerGui then
    warn("فشل تحميل PlayerGui")
    return
end

-- محاولة الحصول على cuffPart
local cuffPart
local success1, err1 = pcall(function()
    cuffPart = Workspace:WaitForChild("town")
        :FindFirstChild("شرطي عسكري 2")
        :FindFirstChild("شرطي عسكري ثابت 2")
        :FindFirstChild("Meshes/مجسم كلبشة جاهز3ب5_Cube.011 (1)")
end)

if not success1 or not cuffPart then
    warn("لم يتم العثور على cuffPart الجديد:", err1)
    return
end

-- محاولة الحصول على الريموت الجديد
local remote
local success2, err2 = pcall(function()
    remote = ReplicatedStorage:WaitForChild("ChatRe")
        :WaitForChild("r3")
        :WaitForChild("Re")
        :WaitForChild("pkajaofqerqjn")
end)

if not success2 or not remote then
    warn("لم يتم العثور على الريموت الجديد:", err2)
    return
end

-- إنشاء واجهة المستخدم
local gui = Instance.new("ScreenGui")
gui.Name = "CuffGui"
gui.ResetOnSpawn = false
gui.Enabled = true
gui.Parent = PlayerGui
print("تم إنشاء الـ GUI بنجاح")

-- إطار
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 200, 0, 100)
frame.Position = UDim2.new(0.5, -100, 0.5, -50)
frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true
frame.Parent = gui

-- زر
local button = Instance.new("TextButton")
button.Size = UDim2.new(1, -10, 1, -10)
button.Position = UDim2.new(0, 5, 0, 5)
button.Text = "Cuff All"
button.TextColor3 = Color3.new(1, 1, 1)
button.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
button.Font = Enum.Font.SourceSansBold
button.TextSize = 24
button.Parent = frame

-- تشغيل الكلبشة
local running = false

button.MouseButton1Click:Connect(function()
    running = not running
    button.Text = running and "Stop Cuff" or "Cuff All"

    if running then
        task.spawn(function()
            while running do
                for _, player in pairs(Players:GetPlayers()) do
                    if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                        local args = {
                            [1] = "Cuff",
                            [2] = cuffPart
                        }
                        local success, err = pcall(function()
                            remote:FireServer(unpack(args))
                        end)
                        if not success then
                            warn("فشل إطلاق الريموت: " .. tostring(err))
                        end
                    end
                end
                task.wait(0.1)
            end
        end)
    end
end)
